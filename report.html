
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>

	<link rel="stylesheet" href="style.css">
</head>
<body>
	<nav class="menu-bar">
  <ul>
    <li><a href="dashboard.html">ğŸ  Dashboard</a></li>
    <li><a href="patient.html">ğŸ§¾ Patients</a></li>
    <li><a href="remedy.html">ğŸ’Š Remedies</a></li>
    <li><a href="prescription.html">ğŸ“„ Prescriptions</a></li>
  
    <li><a href="report.html">ğŸ“Š Reports</a></li>
    <li><a href="#" onclick="logout()">ğŸšª Logout</a></li>
  </ul>
</nav>
<h3>Income Reports</h3>

<input type="date" id="reportDate">
<button onclick="getDailyReport()">Daily Report</button>

<input type="month" id="reportMonth">
<button onclick="getMonthlyReport()">Monthly Report</button>

<select id="reportPatient"  loadReportPatients();></select>
<button onclick="getPatientReport()">Patient Report</button>

<div id="reportResult"></div>
  <script>
function getDailyReport(){

  const date = document.getElementById("reportDate").value;

  post({
    action:"getReport",
    type:"daily",
    date:date
  }).then(showReport);
}
function getMonthlyReport(){

  const month = document.getElementById("reportMonth").value;

  post({
    action:"getReport",
    type:"monthly",
    month:month
  }).then(showReport);
}
  function getPatientReport(){

  const patientId = document.getElementById("reportPatient").value;

  post({
    action:"getReport",
    type:"patient",
    patientId:patientId
  }).then(showReport);
}
    function showReport(res){

  if(!res.success) return;

  document.getElementById("reportResult").innerHTML = `
    <h4>Report Summary</h4>
    <p>Total Visits: ${res.count}</p>
    <p>Total Amount:  ${res.total}</p>
    <p>Total Paid:  ${res.paid}</p>
    <p>Total Due:  ${res.due}</p>
  `;
}
	  function loadReportPatients(){

  post({action:"getPatients"}).then(res=>{

    const select = document.getElementById("reportPatient");
    select.innerHTML = "<option value=''>Select Patient</option>";

    res.data.forEach(p=>{
      select.innerHTML += `
        <option value="${p[0]}">
          ${p[1]} - ${p[4]}
        </option>
      `;
    });

  });
}


	  window.onload = function(){
  loadReportPatients();
};
  </script>  
	<script src="app.js"></script>
	<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js')
    .then(() => console.log("Service Worker Registered"));
}
</script>
</body>
</html>
